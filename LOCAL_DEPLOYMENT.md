# 📱 本地部署指南

本应用是一个纯本地应用，所有数据存储在浏览器的 localStorage 中，无需云端服务器。

## ✅ 应用特点

- ✅ **完全本地运行** - 无需云端服务器
- ✅ **数据本地存储** - localStorage，数据不离开设备
- ✅ **支持 PWA** - 可添加到 iPad 主屏幕，像原生 App 一样使用
- ✅ **离线可用** - Service Worker 缓存，无网络也能使用
- ✅ **局域网访问** - 可在同一局域网内的多设备访问

## 🚀 方案 1：本地网络运行（推荐）

适合家庭局域网使用，所有设备都可以访问。

### 1. 构建生产版本

```bash
npm run build
```

### 2. 启动本地服务器

```bash
# 使用 preview 模式
npm run preview

# 或使用 npx serve
npx serve -s dist -p 3000
```

### 3. 获取局域网 IP

```bash
# macOS/Linux
ifconfig | grep "inet " | grep -v 127.0.0.1

# Windows
ipconfig
```

假设获取到 IP 为 `192.168.1.100`

### 4. 在 iPad 上访问

1. 确保 iPad 和电脑在同一局域网
2. 打开 Safari，访问 `http://192.168.1.100:3000`
3. 点击分享 → 添加到主屏幕
4. 开始使用！

## 🔧 方案 2：开发模式（调试用）

适合开发和调试。

```bash
# 启动开发服务器
npm run dev

# 访问 http://localhost:3000
# 或局域网访问 http://[你的IP]:3000
```

## 💾 数据存储

### 存储位置

所有数据存储在浏览器的 localStorage 中：

- 周计划: `plan_[weekId]`
- 进度单: `progress_[date]`
- 玩家状态: `player_state`
- 自定义任务: `custom_tasks`

### 数据特点

- ✅ **完全本地** - 数据不上传到任何服务器
- ✅ **持久化** - 关闭浏览器后数据保留
- ✅ **设备隔离** - 每个设备独立存储
- ⚠️ **无自动同步** - 不同设备间数据不同步

### 数据备份

**方法 1：浏览器开发工具**
1. 打开浏览器开发工具（F12）
2. Application → Local Storage
3. 右键 → Copy → 保存到文本文件

**方法 2：导出功能（未来实现）**
- 可以添加导出/导入功能
- 导出为 JSON 文件
- 在其他设备导入

## 🔄 多设备使用

### 场景 1：单设备使用（推荐）

- 数据存储在 iPad 本地
- 无需同步，简单可靠
- 适合个人使用

### 场景 2：多设备共享（需额外开发）

如果需要多设备同步，可以考虑：

1. **共享数据库** - 添加后端 API
2. **文件同步** - 通过 iCloud/Dropbox 同步
3. **局域网同步** - 实现设备间数据同步

## 🌐 访问方式对比

| 方式 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| 本地访问 | 简单，无需配置 | 只能在电脑上用 | 开发调试 |
| 局域网访问 | 多设备可用，数据本地 | 需在同一网络 | 家庭使用 |
| PWA 离线 | 添加到主屏幕，像 App | 首次需联网加载 | 日常使用 |

## 📦 生产部署选项

虽然是本地应用，但仍可部署到服务器方便访问：

### 选项 1：静态托管（推荐）

**Vercel/Netlify**
- 完全免费
- 自动 HTTPS
- 全球 CDN
- 数据仍存本地

```bash
# Vercel 部署
npm run deploy
```

### 选项 2：本地 Nginx

```nginx
server {
    listen 80;
    server_name localhost;
    root /path/to/tlga/dist;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

### 选项 3：Docker

```dockerfile
FROM nginx:alpine
COPY dist /usr/share/nginx/html
EXPOSE 80
```

```bash
# 构建并运行
docker build -t tlga .
docker run -p 3000:80 tlga
```

## 🔒 数据安全

### 本地存储优势

- ✅ 数据完全在设备本地
- ✅ 无隐私泄露风险
- ✅ 不依赖第三方服务
- ✅ 永久免费

### 注意事项

- ⚠️ 清除浏览器数据会丢失记录
- ⚠️ 重装系统需要备份数据
- ⚠️ 不同浏览器数据独立

## 🎯 推荐使用方式

### 家庭使用场景

1. **在家用电脑上运行**
   ```bash
   npm run build
   npx serve -s dist -p 3000
   ```

2. **获取局域网 IP**
   - 例如：192.168.1.100

3. **所有家庭设备访问**
   - iPad: `http://192.168.1.100:3000`
   - iPhone: `http://192.168.1.100:3000`
   - 其他设备: `http://192.168.1.100:3000`

4. **添加到主屏幕**
   - 每个设备添加到主屏幕
   - 像原生 App 一样使用

### 个人使用场景

1. **部署到免费托管**
   ```bash
   npm i -g vercel
   vercel --prod
   ```

2. **获得永久网址**
   - 例如：https://tlga.vercel.app

3. **任何设备访问**
   - 打开浏览器访问网址
   - 添加到主屏幕
   - 数据存储在各自设备

## 📱 iPad 最佳体验

### 添加到主屏幕后

- ✅ 全屏显示，无浏览器地址栏
- ✅ 独立应用图标
- ✅ 快速启动
- ✅ 离线可用
- ✅ 像原生 App 一样的体验

### 使用建议

1. 首次访问确保网络通畅（加载资源）
2. 添加到主屏幕
3. 之后可离线使用
4. 定期连网自动更新

## 🆘 常见问题

### Q: 数据会丢失吗？
A: 只要不清除浏览器数据，数据永久保存。建议定期导出备份。

### Q: 可以在多设备同步吗？
A: 默认不同步。每个设备独立存储。如需同步需要额外开发。

### Q: 离线后能用吗？
A: 可以。首次访问后 Service Worker 会缓存所有资源，之后完全离线可用。

### Q: 需要付费吗？
A: 完全免费。无需服务器，无需账号，无需订阅。

### Q: 数据安全吗？
A: 非常安全。数据存储在本地，不上传任何服务器，无隐私泄露风险。

---

## 🎉 快速开始

```bash
# 1. 构建
npm run build

# 2. 启动本地服务器
npx serve -s dist -p 3000

# 3. 在 iPad 上访问
# Safari 打开: http://[你的局域网IP]:3000

# 4. 添加到主屏幕
# 点击分享 → 添加到主屏幕

# 5. 开始使用！
```

**就是这么简单！** 🚀
