# 📚 历史记录页面

## 功能概述

新增历史记录页面，支持按周查看完整的学习历史，包括：
- 📅 周计划
- ✅ 每日进度
- 🎉 审批结果
- 💰 奖励统计

## 🎯 核心功能

### 1. 周导航
- **上一周/下一周** 按钮快速切换
- 显示周标题："2026年第7周"
- 显示日期范围："2月10日 - 2月16日"
- 当前周禁用"下一周"按钮

### 2. 周总结卡片
实时统计本周数据：
- ✅ **完成天数**: X/7
- 💰 **总金币**: 累计获得的金币
- ✨ **总经验**: 累计获得的经验值
- 📋 **完成任务**: 完成的任务总数

### 3. 每日历史记录（可折叠）

每天显示一个卡片，包含：

#### 卡片头部
- 日期（周几）
- 今日标识（金色徽章）
- 状态徽章（待填写/已提交/已审批/已驳回）
- 奖励预览（+XX💰）
- 展开/收起图标

#### 展开内容

**📅 计划任务**
- 显示当天计划的所有任务
- 任务图标 + 名称
- 目标完成程度（如果有）

**✅ 实际完成**
- 每个任务的完成状态（✓完成 / 未完成）
- 实际达成的完成程度
- 获得的奖励（金币+经验）
- 小学霸的备注
- 审批员的意见

**🎉 审批结果**（已审批时）
- 获得金币总计
- 获得经验总计
- 审批评语

## 🎨 视觉设计

### 配色方案
- **主色调**: 粉色渐变（#ff6b9d → #ff9a76）
- **金币色**: 金黄色 (#ffb627)
- **经验色**: 蓝色 (#5eaeff)
- **成功色**: 绿色 (#06d6a0)
- **警告色**: 橙色 (#ffa800)

### 组件样式

#### 周选择器
- 圆角 20px 白色卡片
- 左右按钮：渐变背景 + 悬停上浮
- 中间周信息：大标题 + 小副标题

#### 周总结卡片
- Grid 布局，4列自适应
- 每项：图标 + 标签 + 数值
- 悬停上浮效果

#### 每日卡片
- 圆角 20px 白色卡片
- 头部可点击展开/收起
- 展开内容有下滑动画
- 分级延迟动画（0.05s 增量）

#### 任务项
- 简单任务：单行显示，图标+名称+标签
- 详细任务：多行显示，含状态、奖励、备注
- 备注：左侧彩色边框

#### 审批区块
- 绿色渐变背景
- 奖励统计：Grid 布局
- 评语：白色卡片

### 动画效果

1. **页面加载**: 整体淡入 + 上滑
2. **卡片进场**: 分级延迟上滑
3. **悬停效果**: 上浮 + 阴影增强
4. **展开内容**: 下滑动画
5. **按钮交互**: 缩放 + 阴影变化

## 💻 技术实现

### 数据加载
```typescript
// 1. 加载周计划
await planStore.loadWeek(selectedWeekId)

// 2. 加载所有进度单
await progressStore.loadWeekSheets(selectedWeekId, weekDates)

// 3. 构建 Map 方便查询
dailyPlans: Record<string, DailyPlan>
dailySheets: Record<string, DailyProgressSheet>
```

### 周导航
```typescript
// 获取上一周
getPreviousWeek(weekId): string

// 获取下一周
getNextWeek(weekId): string

// 格式化显示
formatWeekCN(weekId): "2026年第7周"
getWeekRangeCN(weekId): "2月10日 - 2月16日"
```

### 状态管理
```typescript
const selectedWeekId = ref(currentWeek())
const expandedDays = ref(new Set<string>())
const dailyPlans = ref<Record<string, DailyPlan>>({})
const dailySheets = ref<Record<string, DailyProgressSheet>>({})
```

### 周总结计算
```typescript
const weekSummary = computed(() => {
  const sheets = Object.values(dailySheets.value).filter(s => s.settled)
  return {
    completedDays: sheets.length,
    totalGold: sheets.reduce((sum, s) => sum + s.totalGold, 0),
    totalXp: sheets.reduce((sum, s) => sum + s.totalXp, 0),
    totalTasks: sheets.reduce((sum, s) =>
      sum + s.tasks.filter(t => t.completed).length, 0)
  }
})
```

## 🚀 使用场景

### 场景 1: 查看本周完成情况
```
1. 进入历史记录页面（默认显示本周）
2. 查看周总结统计
3. 点击某一天展开详情
4. 查看任务完成情况和获得的奖励
```

### 场景 2: 回顾上周表现
```
1. 点击"上一周"按钮
2. 查看上周的完成情况
3. 展开某天查看具体任务和审批意见
```

### 场景 3: 追踪学习历史
```
1. 连续点击"上一周"
2. 浏览不同周的数据
3. 对比不同周的表现
4. 总结学习规律
```

## 📊 信息层次

```
周选择器
  ├─ 上一周按钮
  ├─ 周标题 + 日期范围
  └─ 下一周按钮

周总结卡片
  ├─ 完成天数
  ├─ 总金币
  ├─ 总经验
  └─ 完成任务数

每日记录列表
  └─ 每日卡片
      ├─ 头部（日期、状态、奖励）
      └─ 展开内容
          ├─ 计划任务
          ├─ 实际完成
          └─ 审批结果
```

## 🎯 设计亮点

### 1. 一页看全周
无需跳转，折叠式设计让整周数据一览无余

### 2. 清晰的信息分层
计划 → 完成 → 审批，逻辑清晰，易于理解

### 3. 丰富的状态指示
- 徽章显示状态
- 颜色区分类型
- 图标增强识别

### 4. 流畅的动画反馈
- 展开/收起流畅
- 悬停有反馈
- 加载有动画

### 5. 完整的历史回顾
- 周导航自由切换
- 数据完整展示
- 奖励清晰可见

## 🎨 响应式设计

### 移动端优化
```css
@media (max-width: 768px) {
  /* 周选择器垂直布局 */
  .week-selector {
    flex-direction: column;
  }

  /* 总结卡片2列布局 */
  .summary-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
```

## ✨ 用户体验优化

| 特性 | 实现方式 | 效果 |
|------|----------|------|
| **快速导航** | 上一周/下一周按钮 | 一键切换周 |
| **状态可见** | 头部状态徽章 | 快速识别状态 |
| **按需展开** | 折叠式设计 | 减少信息过载 |
| **完整记录** | 三段式展示 | 全面了解历史 |
| **数据统计** | 周总结卡片 | 直观看到成果 |
| **视觉反馈** | 丰富动画 | 操作流畅自然 |

## 🌐 访问入口

### 导航栏
```
仪表盘 | 周计划 | 每日进度 | 审批 | 历史记录 ← 新增
```

### URL
```
http://localhost:3000/history          # 查看当前周
http://localhost:3000/history/2026-W06 # 查看指定周
```

## 📱 交互设计

### 点击交互
- **周选择器按钮**: 切换周
- **每日卡片头部**: 展开/收起详情
- **任务项**: 无交互（只读）

### 视觉反馈
- **按钮悬停**: 上浮 + 阴影
- **卡片悬停**: 阴影增强
- **展开动画**: 下滑渐现
- **加载状态**: 旋转图标

## 🎉 效果总结

**历史记录页面让学习历程清晰可见！**

- ✅ 完整记录每周学习情况
- ✅ 清晰展示计划与完成对比
- ✅ 直观呈现审批结果和奖励
- ✅ 便捷的周导航回顾历史
- ✅ 精美的视觉设计提升体验

---

**功能完成！** 📚✨

现在可以随时回顾学习历史，追踪成长轨迹！
