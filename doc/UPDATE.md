# 🎉 系统更新：全新的周计划工作流

## ✨ 主要变更

### 1. 任务类型重新设计
根据实际需求，任务系统完全重构，使用真实的任务表：

#### 学业类
- **学校作业**: 完成当天作业 (+1💰)
- **奥数简单版**:
  - 基础完成 (+2💰)
  - 正确率80%+ (+3💰)
  - 正确率100% (+4💰)

#### 运动类
- **抛接球挑战**:
  - 连续30个 (+1💰)
  - 连续50个 (+2💰)
  - 连续100个 (+3💰)

#### 语言学习
- **背诵任务**: 完成背诵 (+1💰)
- **法语阅读**: 完成阅读 (+2💰, 额外加成+2💰)
- **英语阅读**: 完成阅读 (+1💰)
- **额外奖励**:
  - 完成2项 (+2💰)
  - 完成3项 (+3💰)

#### 艺术类
- **钢琴练习**:
  - 练习20分钟 (+1💰)
  - 练习30分钟 (+2💰)
- **写字练习**:
  - 练习20分钟 (+1💰)
  - 练习40分钟 (+2💰)

#### 行为习惯
- **有礼貌**: +2💰
- **处理矛盾**: +3💰 +15✨

### 2. 全新的周计划工作流

#### 旧流程（已废弃）
- 每天单独记录任务
- 实时计算奖励
- 立即结算

#### 新流程 ✨
1. **周一制定计划**: 为本周7天设定目标任务
2. **每天更新**: 标记完成状态和实际达成的完成程度
3. **查看进度**: 实时预览每日奖励和本周总结
4. **保存计划**: 所有更新保存到周计划文件

### 3. 数据结构变化

#### 新增文件
```
data/
└── weeks/
    └── 2026-W07/
        └── plan.json    # 周计划（包含每日目标和完成情况）
```

#### 周计划结构
```json
{
  "weekId": "2026-W07",
  "startDate": "2026-02-10",
  "endDate": "2026-02-16",
  "dailyGoals": [
    {
      "date": "2026-02-10",
      "tasks": [
        {
          "taskId": "homework",
          "completed": false
        },
        {
          "taskId": "math-simple",
          "targetVariant": "正确率80%+",
          "completed": false,
          "achievedVariant": "正确率100%"  // 实际达成
        }
      ],
      "status": "pending"  // pending | in-progress | completed
    }
  ]
}
```

## 🚀 使用新系统

### 访问地址
**http://localhost:3001/**

### 操作流程

#### 1. 访问周计划页面
点击导航栏的"周计划"按钮

#### 2. 为每一天添加任务
- 点击某一天展开详情
- 从下拉菜单选择任务类型
- 点击"添加任务"

#### 3. 设置目标完成程度
对于有多种完成程度的任务（如奥数、抛接球），可以设置目标等级

#### 4. 每天更新完成情况
- 勾选已完成的任务
- 选择实际达成的完成程度
- 查看实时奖励预览

#### 5. 查看本周总结
页面顶部显示：
- 完成天数 (X/7)
- 总金币
- 总经验值

#### 6. 保存计划
点击"保存计划"按钮保存所有更改

## 📊 功能特性

### ✅ 任务变体系统
不同完成程度获得不同奖励：
- 奥数：基础(+2) → 80%(+3) → 100%(+4)
- 抛接球：30个(+1) → 50个(+2) → 100个(+3)
- 钢琴：20分钟(+1) → 30分钟(+2)

### ✅ 语言学习组合奖励
- 完成2项语言学习: 额外+2💰
- 完成3项语言学习: 额外+3💰
- 自动检测和计算

### ✅ 实时奖励预览
展开某一天查看：
- 每个任务的奖励
- 组合奖励
- 当日总奖励

### ✅ 进度追踪
- 每天显示完成状态（未开始/进行中/已完成）
- 完成任务数统计
- 本周总览

## 🔄 迁移说明

### 旧数据兼容性
旧的每日日志系统（`daily-logs/`）已废弃，新系统使用 `plan.json`

### 重新开始
```bash
# 生成新的演示数据
npm run seed-new

# 或初始化空数据
npm run init-data
```

## 📝 演示数据

已生成两周数据：
- **2026-W06**: 上周（已完成）
- **2026-W07**: 本周（待计划）

### 本周计划示例
- 周一: 作业 + 奥数 + 抛接球 + 英语阅读
- 周二: 作业 + 奥数100% + 法语阅读 + 钢琴20分钟
- 周三: 作业 + 抛接球50个 + 背诵 + 英语 + 写字
- 周四: 作业 + 奥数 + 法语 + 有礼貌
- 周五: 作业 + 抛接球 + 英语 + 法语 + 钢琴30分钟
- 周六: 奥数100% + 抛接球100个 + 钢琴 + 写字40分钟
- 周日: 背诵 + 英语 + 法语 + 处理矛盾(+3💰+15✨)

## 🎯 设计理念

### 为什么改为周计划？
1. **更好的规划**: 提前规划整周，而不是每天临时记录
2. **目标导向**: 设定目标完成程度，更有激励性
3. **灵活调整**: 可以随时修改计划和完成情况
4. **全局视角**: 一眼看到整周的安排和进度

### 为什么简化奖励系统？
1. **专注基础**: 先把核心任务系统做好
2. **真实数据**: 使用实际的任务列表
3. **清晰明了**: 奖励规则简单直接
4. **易于扩展**: 后续可以添加连击、成就等高级功能

## 🔜 后续计划

可以逐步添加的功能：
- [ ] 连击系统
- [ ] 成就系统
- [ ] 周挑战
- [ ] 副本进度
- [ ] 等级特权
- [ ] 许愿池

## 🚀 立即体验

```bash
# 访问应用
http://localhost:3001/

# 页面
- 仪表盘: http://localhost:3001/
- 周计划: http://localhost:3001/weekly
```

---

**开始你的新旅程！** 📅✨
